# exec_always execute when I3 is restarted too (not just at startx)
# --no-startup-id
#     Use for applications that don't have startup-notifications
#     Note: Must come immediately after exec
#     Note: If your cursor is in loading state at startup, it may be because one
#           of the exec are missing --no-startup-id


# Tokyo Night color palette (fixed 6-digit hex codes)
# set $bg      #1a1b26
# set $fg      #c0caf5
# set $black   #15161e
# set $gray    #414868
# set $red     #f7768e
# set $green   #9ece6a
# set $yellow  #e0af68
# set $blue    #7aa2f7
# set $magenta #bb9af7
# set $cyan    #7dcfff
# set $white   #a9b1d6
# set $orange  #ff9e64
set $bg #1a1b26
set $fg #c0caf5
set $black #15161e
set $gray #414868
set $red #f7768e
set $green #9ece6a
set $yellow #e0af68
set $blue #7aa2f7
set $magenta #bb9af7
set $cyan #7dcfff
set $white #a9b1d6
set $orange #ff9e64



# Window borders
set $border_active $blue
set $border_inactive $gray

# Start password manager service (keyring)
exec --no-startup-id gnome-keyring-daemon --start --components=secrets

# network manager
exec_always --no-startup-id nm-applet

# alternate layout between horizontal and vertical when opening new windows
exec_always --no-startup-id alternating_layouts.py

# screenshot tool
exec_always --no-startup-id flameshot

# gdrive sync
exec_always --no-startup-id i3_isync.sh

# Set wallpaper
exec_always --no-startup-id feh --bg-scale /home/siliwho/Downloads/1006667.jpg

# start composite manager picom (compton fork)
# It's nice, but bugs...
# exec_always --no-startup-id i3_picom.sh

# Set modifier to Super (Windows) key
set $mod Mod4

new_window pixel 1

# Won't wrap around if you e.g. press left when you are at most left
force_focus_wrapping yes

client.focused          #7aa2f7 #7aa2f7 #c0caf5 #7aa2f7 #7aa2f7
client.focused_inactive #414868 #414868 #a9b1d6 #414868 #414868
client.unfocused        #414868 #414868 #a9b1d6 #414868 #414868


# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# Back and Forth
workspace_auto_back_and_forth no

# kill focused window
bindsym $mod+Shift+C kill

# Open terminal in same pwd
bindsym $mod+Return exec --no-startup-id alacritty --working-directory "`xcwd`"

# Don't open in same pwd
bindsym $mod+Shift+Return exec --no-startup-id kitty

# Start program loader (Updated with Tokyo Night colors)
# bindsym $mod+d exec --no-startup-id j4-dmenu-desktop --dmenu='dmenu -i -b -fn "JetBrains Mono-10" -nb '"$bg"' -sb '"$blue"' -nf '"$fg"' -sf '"$bg"' -p "run: "'
bindsym $mod+d exec --no-startup-id ~/.config/rofi/launchers/type-3/launcher.sh


# change focus (use window-tool to make focus behave intuitively)
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# Start timer
bindsym $mod+F1 exec --no-startup-id "~/bin/timer.sh 1500"
bindsym $mod+F2 exec --no-startup-id "~/bin/timer.sh 300"

# move focused window
bindsym $mod+Shift+H move left
bindsym $mod+Shift+J move down
bindsym $mod+Shift+K move up
bindsym $mod+Shift+L move right

bindsym $mod+Tab workspace next
bindsym $mod+Shift+Tab focus prev


# Fullscreen screenshot → save to file
bindsym Print exec scrot '/home/siliwho/Pictures/screenshots/%Y-%m-%d_%H-%M-%S.png' && notify-send "Screenshot taken"

# Select area screenshot → save to file
bindsym $mod+Print exec maim -s '/home/siliwho/Pictures/screenshots/%Y-%m-%d_%H-%M-%S.png' && notify-send "Screenshot taken"

# Fullscreen screenshot → copy to clipboard
bindsym Shift+Print exec scrot -z -e 'xclip -selection clipboard -t image/png -i $f' && notify-send "Screenshot copied to clipboard"

# Select area screenshot → copy to clipboard
bindsym $mod+Shift+Print exec maim -s | xclip -selection clipboard -t image/png && notify-send "Screenshot copied to clipboard"


# split in horizontal orientation
bindsym $mod+underscore split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# assign workspace variables
set $WS1 1
set $WS2 2
set $WS3 3
set $WS4 4
set $WS5 5

# switch workspace
bindsym $mod+1 workspace $WS1
bindsym $mod+2 workspace $WS2
bindsym $mod+3 workspace $WS3
bindsym $mod+4 workspace $WS4
bindsym $mod+5 workspace $WS5

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $WS1
bindsym $mod+Shift+2 move container to workspace $WS2
bindsym $mod+Shift+3 move container to workspace $WS3
bindsym $mod+Shift+4 move container to workspace $WS4
bindsym $mod+Shift+5 move container to workspace $WS5

# restart i3 inplace (preserves layout/session)
bindsym $mod+Shift+R restart

# exit i3 (logs you out of your X session)
bindsym $mod+Shift+E exit

# don't change focus on mouse hover
focus_follows_mouse no

# quick binds to open programs
bindsym $mod+t exec nautilus "`xcwd`"
bindsym $mod+w exec firefox

# use mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# i3 gaps
# Set border pixel when not using picom for determining selected window
# for_window [class=".*"] border pixel 1
smart_gaps on
smart_borders on
gaps inner 0
gaps outer 0

# set popups during fullscreen mode
popup_during_fullscreen smart

# volume -- UPDATED FOR INSTANT REFRESH
bindsym XF86AudioLowerVolume    exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -5% && pkill -RTMIN+10 i3blocks
bindsym XF86AudioRaiseVolume    exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +5% && pkill -RTMIN+10 i3blocks
bindsym XF86AudioMute           exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle && pkill -RTMIN+10 i3blocks

# Info bar at top
bar {
	position top
    status_command          i3blocks
    bindsym button4         nop
    bindsym button5         nop
    tray_output             primary
    separator_symbol        " "
    workspace_buttons       yes
    strip_workspace_numbers yes
    # Font for icons and font for text
    font pango:FontAwesome, Iosevka Nerd Font Mono 10
    # font pango:Iosevka Nerd Font Mono 10
    tray_padding 1

    colors {
        background $bg
        statusline $fg
        separator $gray

        # workspace id, border, background, text
        focused_workspace  $blue $blue $bg
        active_workspace   $blue $gray $fg
        inactive_workspace $bg $bg $white
        urgent_workspace   $red $red $fg
    }
}

